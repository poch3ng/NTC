要讓左邊的 `TreeView` 目錄更美觀，我們可以透過 CSS 優化其外觀，包括調整字體、間距、圖標、hover 效果，以及添加層次感的縮進或線條。以下是一些具體的改進建議，並提供修改後的程式碼。

### 改進目標
1. **視覺層次**：為父節點和子節點添加縮進，增強層次感。
2. **圖標樣式**：為展開/收合節點添加自定義圖標（如加號/減號或箭頭）。
3. **交互效果**：優化 hover 和選中狀態的背景色與動畫。
4. **一致性**：確保字體、顏色與整體設計（深藍色和淺藍色主題）協調。
5. **清爽排版**：調整間距和邊框，使選單更整潔。

### 修改 CSS
以下是針對 `TreeView` 的 CSS 改進，更新 `.sidebar` 和 `.treeview-style` 相關樣式，並添加新樣式來美化節點。

#### 更新後的 CSS
將以下 CSS 替換原始程式碼中的 `<style>` 部分（僅列出與 `TreeView` 相關的改動，其他樣式保持不變）：

```css
.sidebar {
    background-color: #e3f2fd; /* 淺藍色 */
    width: 220px;
    padding: 20px;
    overflow-y: auto; /* 選單過長時可滾動 */
}

.treeview-style {
    font-size: 15px; /* 字體大小 */
    color: #003366; /* 深藍色文字 */
}

.treeview-style ul {
    list-style: none;
    padding-left: 0;
}

.treeview-style li {
    margin-bottom: 8px; /* 節點間距 */
    position: relative; /* 為圖標定位 */
}

.treeview-style a {
    color: #003366;
    padding: 8px 12px;
    display: block;
    border-radius: 4px;
    text-decoration: none;
    transition: background-color 0.2s ease, color 0.2s ease;
    position: relative;
    padding-left: 30px; /* 為圖標預留空間 */
}

.treeview-style a:hover {
    background-color: #cbe3ff; /* hover 時的淺藍背景 */
    color: #002244; /* 略深的文字色 */
}

.treeview-style a.selected {
    background-color: #90caf9; /* 選中狀態的背景 */
    color: #003366;
    font-weight: bold;
}

/* 子節點縮進 */
.treeview-style ul ul {
    padding-left: 20px; /* 子節點縮進 */
}

/* 展開/收合圖標 */
.treeview-style .expandable > a::before {
    content: '\25B6'; /* 右箭頭（收合） */
    position: absolute;
    left: 10px;
    font-size: 12px;
    color: #003366;
    transition: transform 0.2s ease;
}

.treeview-style .expandable-hitarea::before {
    content: '\25BC'; /* 下箭頭（展開） */
    position: absolute;
    left: 10px;
    font-size: 12px;
    color: #003366;
}

/* 無子節點的項目 */
.treeview-style .leaf > a::before {
    content: '\2022'; /* 小圓點 */
    position: absolute;
    left: 10px;
    font-size: 12px;
    color: #003366;
}
```

### HTML 變更
`TreeView` 的 HTML 部分保持不變，但需要確保 `TreeView` 的 CSS 類正確應用：

```html
<div class="sidebar">
    <asp:TreeView ID="TreeView1" runat="server" CssClass="treeview-style" ShowExpandCollapse="True" ExpandDepth="1" />
</div>
```

### 改進效果說明
1. **視覺層次**：
   - 子節點縮進 20px（`ul ul { padding-left: 20px; }`），使層次更清晰。
   - 使用圓點（`•`）標記無子節點的項目，箭頭（`▶`/`▼`）標記可展開/收合節點。
2. **圖標樣式**：
   - 為展開/收合節點添加箭頭圖標，動態顯示收合（`▶`）或展開（`▼`）狀態。
   - 無子節點的項目顯示小圓點，提升辨識度。
3. **交互效果**：
   - hover 時背景變為淺藍色（`#cbe3ff`），文字略加深（`#002244`）。
   - 選中狀態（`.selected`）顯示更深的藍色背景（`#90caf9`）和加粗文字。
   - 所有過渡效果（`transition`）平滑，提升交互體驗。
4. **一致性**：
   - 字體大小設為 15px，與整體設計協調。
   - 顏色使用現有主題的深藍（`#003366`）和淺藍（`#e3f2fd`）。
5. **清爽排版**：
   - 節點間距增加到 8px（`margin-bottom: 8px`）。
   - 選項的內距（`padding: 8px 12px`）更舒適，左側預留 30px 給圖標。

### 注意事項
1. **ASP.NET TreeView 行為**：
   - ASP.NET 的 `TreeView` 會自動生成一些類（如 `expandable`、`expandable-hitarea`、`leaf`），上述 CSS 已針對這些類進行樣式化。
   - 如果 `TreeView` 的 HTML 結構不同（例如自定義類），可能需要微調 CSS 選擇器。
2. **選中狀態**：
   - `.selected` 類需要透過程式碼（C# 或 JavaScript）動態添加到當前選中的 `<a>` 標籤。如果尚未實現，可以在後端設置 `TreeView` 的 `SelectedNodeStyle` 或用 JavaScript 處理。
3. **圖標字體**：
   - 使用 Unicode 字符（`▶`、`▼`、`•`）作為圖標，無需額外圖片。如果需要更精緻的圖標，可以引入字體圖標庫（如 Font Awesome），但需額外引用。
4. **響應式**：
   - 目前樣式針對固定寬度（220px）的側邊欄設計。如果需要支援手機端，建議添加媒體查詢（`@media`）來調整字體大小或縮進。

### 可選增強
如果想進一步美化，可以考慮：
- **線條指引**：為節點添加垂直或水平連線，模擬樹狀結構。
- **動畫效果**：為展開/收合添加淡入淡出動畫（需 JavaScript 輔助）。
- **字體圖標**：使用 Font Awesome 或 Material Icons 替代 Unicode 圖標。
- **主題切換**：支援暗色模式，根據用戶偏好切換側邊欄背景。

### 完整程式碼
以下是整合後的完整程式碼（僅更新 `<style>` 部分，其他保持不變）：

```html
<!DOCTYPE html>
<html>
<head runat="server">
    <title>南亞科技系統</title>
    <link href="Content/bootstrap.css" rel="stylesheet" />
    <script src="Scripts/bootstrap.bundle.js"></script>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            font-family: "Segoe UI", "微軟正黑體", sans-serif;
        }

        .header {
            background-color: #003366;
            color: white;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .header img {
            height: 40px;
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        .header h4 {
            margin: 0;
        }

        .sidebar {
            background-color: #e3f2fd;
            width: 220px;
            padding: 20px;
            overflow-y: auto;
        }

        .treeview-style {
            font-size: 15px;
            color: #003366;
        }

        .treeview-style ul {
            list-style: none;
            padding-left: 0;
        }

        .treeview-style li {
            margin-bottom: 8px;
            position: relative;
        }

        .treeview-style a {
            color: #003366;
            padding: 8px 12px;
            display: block;
            border-radius: 4px;
            text-decoration: none;
            transition: background-color 0.2s ease, color 0.2s ease;
            position: relative;
            padding-left: 30px;
        }

        .treeview-style a:hover {
            background-color: #cbe3ff;
            color: #002244;
        }

        .treeview-style a.selected {
            background-color: #90caf9;
            color: #003366;
            font-weight: bold;
        }

        .treeview-style ul ul {
            padding-left: 20px;
        }

        .treeview-style .expandable > a::before {
            content: '\25B6';
            position: absolute;
            left: 10px;
            font-size: 12px;
            color: #003366;
            transition: transform 0.2s ease;
        }

        .treeview-style .expandable-hitarea::before {
            content: '\25BC';
            position: absolute;
            left: 10px;
            font-size: 12px;
            color: #003366;
        }

        .treeview-style .leaf > a::before {
            content: '\2022';
            position: absolute;
            left: 10px;
            font-size: 12px;
            color: #003366;
        }

        .content {
            flex-grow: 1;
            padding: 20px;
            background-color: #fff;
        }

        .footer {
            background: linear-gradient(to right, #b3e5fc, #e1f5fe);
            padding: 10px 20px;
            text-align: center;
            color: #333;
            font-size: 14px;
        }

        .layout {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .main-area {
            display: flex;
            flex-grow: 1;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <form id="form1" runat="server" class="layout">
        <!-- 頂部 -->
        <div class="header">
            <img src="https://www.nanya.com/assets/img/logo.svg" alt="南亞科技" />
            <h4>南亞科技內部系統</h4>
        </div>

        <!-- 中間主要區域 -->
        <div class="main-area">
            <!-- 左側選單 -->
            <div class="sidebar">
                <asp:TreeView ID="TreeView1" runat="server" CssClass="treeview-style" ShowExpandCollapse="True" ExpandDepth="1" />
            </div>

            <!-- 右側主內容 -->
            <div class="content">
                <asp:ContentPlaceHolder ID="MainContent" runat="server" />
            </div>
        </div>

        <!-- 底部 -->
        <div class="footer">
            © 2025 南亞科技股份有限公司. 保留所有權利。
        </div>
    </form>
</body>
</html>
```

### 下一步
- **測試**：請在瀏覽器中測試新樣式，確認 `TreeView` 的層次、圖標和交互效果是否符合預期。
- **選中狀態實現**：如果需要動態高亮選中節點，可以提供後端（C#）或前端（JavaScript）程式碼，我可以幫忙添加。
- **額外需求**：如果想添加線條、動畫或更現代化的圖標，請告訴我，我可以提供進一步的程式碼（例如引入 Font Awesome 或 CSS 動畫）。

如果有任何問題或想微調某部分，請隨時告訴我！

了解，你希望 「系統名稱」在最上方 header 的正中間顯示，而左邊是南亞科技的 LOGO。
以下是符合你需求的做法：


---

✅ 最上方 Header：LOGO + 中間置中的系統名稱

🔧 修改後的 HTML 結構（放在 Site.Master 的 <body> 裡）

<!-- 頂部 header -->
<div class="header d-flex align-items-center justify-content-between px-3" style="background-color: #003366; color: white; height: 60px;">
  <!-- 左邊 LOGO -->
  <div class="d-flex align-items-center">
    <img src="https://www.nanya.com/assets/img/logo.svg" alt="南亞科技" style="height: 40px;">
  </div>

  <!-- 中間 系統名稱（絕對置中） -->
  <div class="position-absolute top-50 start-50 translate-middle-x" style="white-space: nowrap;">
    <h5 class="mb-0" style="color: white;">南亞科技內部系統</h5>
  </div>

  <!-- 右邊空欄（保留空間保持中間） -->
  <div style="width: 40px;"></div>
</div>


---

✅ 為什麼這樣可以置中？

區塊	說明

position-absolute + translate-middle-x	讓系統名稱絕對置中，不受左右欄影響
左邊 Logo、右邊空欄	保持視覺平衡，讓中間文字真的「在中間」



---

🖼️ 畫面效果：

┌────────────────────────────────────────────┐
│  [LOGO]           南亞科技內部系統          [空] │  ← 深藍背景
└────────────────────────────────────────────┘


---

✅ 建議補充 CSS（可選）

放在 <style> 中做整體一致性：

.header h5 {
  font-weight: 600;
  font-size: 18px;
  letter-spacing: 1px;
}


---

如果你需要在小螢幕 RWD 下 LOGO 收合、系統名稱置頂，我也可以幫你擴充為 RWD 版本。
你可以先把這段貼上測試，有問題我幫你微調。需要我幫你套進整份範例嗎？



很好，你的需求明確且簡潔，我幫你整理成 三大區塊：


---

🎯 你要的版面分區：

[ 頂部 ]：深藍色背景 + LOGO + 系統名稱（橫向置中）
[ 左欄 ]：TreeView 垂直選單，淺藍背景，字體好看
[ 主內容區 ]：白底，顯示頁面內容
[ 底部 ]：水藍色漸層 + 版權資訊


---

✅ 完整 HTML 範例（可放在 Site.Master）

你只需要直接貼上這份結構，然後微調文字與連結即可。

<!DOCTYPE html>
<html>
<head runat="server">
    <title>南亞科技系統</title>
    <link href="Content/bootstrap.css" rel="stylesheet" />
    <script src="Scripts/bootstrap.bundle.js"></script>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            font-family: "Segoe UI", "微軟正黑體", sans-serif;
        }

        .header {
            background-color: #003366; /* 深藍色 */
            color: white;
            padding: 10px 20px;
            display: flex;
            align-items: center;
        }

        .header img {
            height: 40px;
            margin-right: 15px;
        }

        .sidebar {
            background-color: #e3f2fd; /* 淺藍色 */
            width: 220px;
            padding: 20px;
        }

        .sidebar .treeview-style a {
            color: #003366;
            padding: 6px 12px;
            display: block;
            border-radius: 4px;
            text-decoration: none;
            transition: background-color 0.2s ease;
        }

        .sidebar .treeview-style a:hover {
            background-color: #cbe3ff;
        }

        .content {
            flex-grow: 1;
            padding: 20px;
            background-color: #fff;
        }

        .footer {
            background: linear-gradient(to right, #b3e5fc, #e1f5fe); /* 水藍漸層 */
            padding: 10px 20px;
            text-align: center;
            color: #333;
            font-size: 14px;
        }

        .layout {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .main-area {
            display: flex;
            flex-grow: 1;
            overflow: hidden;
        }

        .treeview-style ul {
            list-style: none;
            padding-left: 0;
        }

        .treeview-style li {
            margin-bottom: 6px;
        }
    </style>
</head>
<body>
    <form id="form1" runat="server" class="layout">
        <!-- 頂部 -->
        <div class="header">
            <img src="https://www.nanya.com/assets/img/logo.svg" alt="南亞科技" />
            <h4 class="mb-0">南亞科技內部系統</h4>
        </div>

        <!-- 中間主要區域 -->
        <div class="main-area">
            <!-- 左側選單 -->
            <div class="sidebar">
                <asp:TreeView ID="TreeView1" runat="server" CssClass="treeview-style" ShowExpandCollapse="True" ExpandDepth="1" />
            </div>

            <!-- 右側主內容 -->
            <div class="content">
                <asp:ContentPlaceHolder ID="MainContent" runat="server" />
            </div>
        </div>

        <!-- 底部 -->
        <div class="footer">
            © 2025 南亞科技股份有限公司. 保留所有權利。
        </div>
    </form>
</body>
</html>


---

✅ TreeView 建議設定

若你還沒指定資料來源，可以這樣寫：

<asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server" />
<asp:TreeView ID="TreeView1" runat="server"
              DataSourceID="SiteMapDataSource1"
              CssClass="treeview-style"
              ShowExpandCollapse="true"
              ExpandDepth="1" />


---

🔧 你可以調整的內容：

元件	想改變可以調整的地方

LOGO 圖片	替換 <img> 的 src
系統名稱	替換 <h4> 裡的文字
選單結構	改 SiteMap / TreeView
字型與顏色	調整 CSS .header, .sidebar



---

這樣你會有一個清爽、專業且接近南亞風格的 WebForm 系統主架構。
完成後若要加強 RWD、icon 或功能我也可以繼續幫你。
需要我幫你改進 TreeView 的項目顯示嗎？



太好，這裡是你要將 VB WebForm 的 TreeView 控制項整合進 Bootstrap 左側展開選單樣式的 逐步教學：


---

✅ 第一步：調整整體版面為「左側選單 + 右側主內容」

1. 打開 Site.Master


2. 找到 <body> 裡的 <form> 標籤


3. 修改為以下 Bootstrap 結構：



<body>
  <form id="form1" runat="server">
    <div class="d-flex">
      <!-- 左側 TreeView -->
      <div class="bg-light border-end p-3 vh-100" style="width: 220px;">
        <asp:TreeView ID="TreeView1" runat="server" CssClass="treeview-style" />
      </div>

      <!-- 右側主內容 -->
      <div class="flex-grow-1 p-4">
        <asp:ContentPlaceHolder ID="MainContent" runat="server" />
      </div>
    </div>
  </form>
</body>

🔎 重點：

d-flex：水平排列兩欄

bg-light：左欄背景淺灰

border-end：右側加邊框

vh-100：側欄高 100% 視窗高度

flex-grow-1：右側自動撐滿剩餘寬度



---

✅ 第二步：加 Bootstrap 引入（若還沒加）

在 Site.Master 的 <head> 加入：

<link href="Content/bootstrap.css" rel="stylesheet" />
<script src="Scripts/bootstrap.bundle.js"></script>


---

✅ 第三步：讓 TreeView 美化為現代樣式

在 Site.css 或 <style> 加入以下 CSS：

.treeview-style ul {
  list-style: none;
  padding-left: 0.5rem;
  margin: 0;
}

.treeview-style li {
  padding: 6px 0;
}

.treeview-style a {
  color: #333;
  text-decoration: none;
  display: block;
  padding: 6px 12px;
  border-radius: 4px;
  transition: background 0.2s ease;
}

.treeview-style a:hover {
  background-color: #e9ecef;
  color: #005BAC;
}


---

✅ 第四步：TreeView 設定（在後台或前端都可）

指定 TreeView 使用樣式：


TreeView1.CssClass = "treeview-style"
TreeView1.ShowExpandCollapse = True
TreeView1.ExpandDepth = 1

也可以寫在前端：

<asp:TreeView ID="TreeView1" runat="server" CssClass="treeview-style" ShowExpandCollapse="True" ExpandDepth="1" />


---

✅ 第五步：資料來源設定（如使用 SiteMap）

如果你使用 SiteMapDataSource，請這樣設定：

<asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server" />
<asp:TreeView ID="TreeView1" runat="server" DataSourceID="SiteMapDataSource1" CssClass="treeview-style" />


---

✅ 第六步：測試與調整

✔️ 點開頁面 → 左邊會顯示選單
✔️ 點連結 → 導入目標頁面
✔️ 縮放畫面 → 高度與排版保持正常


---

✅ 下一步提示

若要支援 RWD (手機收合)，可以加入 Offcanvas 或按鈕開關

若要加上 Icon，可搭配 FontAwesome 或 Bootstrap Icon



---

你可以一個步驟一個步驟慢慢套用。
完成第一步後跟我說，我會指引你進入下一步細調，包含 hover 效果、展開符號、收合控制等。你現在做到哪一步了？

