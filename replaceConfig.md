如果沒有 API，你可以使用 RPA 工具（如 UiPath） 模擬人類操作來實現目標，以下是具體步驟：


---

解決方案設計

目標

1. 從 web.config 文件中提取變數。


2. 模擬操作 DevOps Web 界面，將變數添加到變數組。




---

實現方法

1. 提取 web.config 文件中的變數

使用正則表達式提取所有變數。

1. 讀取文件

使用 UiPath 的 Read Text File 活動讀取 web.config 文件，儲存在變數 configContent 中。



2. 正則表達式提取變數

使用 Matches 活動設置正則表達式，例如：

__[\w]+__

提取結果存入 IEnumerable<Match>。



3. 存儲變數

使用 For Each 迴圈將變數存入清單（List）。





---

2. 模擬 DevOps Web 界面操作

模擬操作瀏覽器界面，手動新增變數到變數組。

1. 開啟 DevOps 界面

使用 Open Browser 活動，打開 Azure DevOps 的變數組頁面。

登入系統（如果需要），使用 UiPath 的 Type Into 和 Click 活動填寫帳號密碼。



2. 定位變數組

使用 Click 活動進入目標變數組（或先創建一個新的變數組）。



3. 新增變數

在變數添加欄中，使用迴圈 (For Each) 模擬輸入每個變數：

使用 Type Into 輸入變數名稱。

使用 Type Into 或直接操作界面輸入變數值。

點擊確認按鈕（Click 活動）。




4. 保存變數組

使用 Click 活動點擊保存按鈕。





---

流程細節

1. 錯誤處理

為每一步添加 Try-Catch，確保流程穩定。

如果操作失敗（例如網頁載入問題），重試該步驟。



2. 動態設置 Selector

確保每個 Click 和 Type Into 活動的 Selector 是動態的，以適應不同變數的輸入。



3. 變數校驗

在新增變數前，檢查變數是否已存在，避免重複輸入。

使用 UiPath 的 Get Text 活動確認界面是否顯示該變數。





---

優化選項

1. 批量輸入

如果 DevOps 支持多行輸入，則可以將所有變數拼接成一段文字，批量粘貼。



2. 記錄操作日誌

使用 Log Message 活動記錄每個變數的操作狀態（成功/失敗）。



3. 動態變數值

若變數值需要根據條件計算，可以在 UiPath 中預先準備數據。





---

例外情況處理

網頁延遲：在操作界面前，使用 Delay 或 On Element Appear 活動檢查網頁是否完全載入。

文件變數格式不符：在讀取變數後，檢查正則表達式的匹配結果，避免空數據進入。



---

結論

通過模擬人類操作，可以完整實現將 web.config 中的變數添加至 DevOps 變數組的需求。若有具體操作難點或流程需要調整，可以提供更多系統細節，我會進一步優化設計！

