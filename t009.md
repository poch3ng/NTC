明白了，您有兩台測試機（假設為A和B），都已經在IIS中開啟了匿名驗證，但B這台卻回傳401錯誤（未授權），而且只有在開啟Windows驗證後才能正常訪問`.asmx`檔案（應該是Web Service檔案）。這聽起來像是B機器的設定或環境與A不同，導致匿名驗證未正確生效。讓我們一步步排查問題：

---

### 可能原因與解決步驟

#### 1. 確認IIS匿名驗證是否真的啟用
- 在B機器上：
  1. 打開IIS管理員。
  2. 選擇您的網站，然後點擊「驗證」(Authentication)。
  3. 確認「匿名驗證」是啟用狀態，且其他驗證方式（如Windows驗證）是禁用狀態。
- 如果匿名驗證已啟用，但仍回401，可能是後續的權限或配置問題。

#### 2. 檢查匿名用戶的權限
- IIS使用匿名驗證時，會以特定的帳戶（通常是`IUSR`）來存取資源。
- 在B機器上：
  1. 在「驗證」設定中，點擊「匿名驗證」後選擇「編輯」。
  2. 確認匿名用戶身份是`IUSR`還是其他帳戶。
  3. 檢查`.asmx`檔案所在的實體資料夾（例如`C:\inetpub\wwwroot`），右鍵點擊資料夾 >「屬性」>「安全性」，確保`IUSR`有「讀取」和「執行」權限。
- 如果缺少權限，點擊「編輯」添加`IUSR`並授予權限。

#### 3. 檢查Web.config設定
- `.asmx`檔案通常由ASP.NET處理，網站的`Web.config`可能覆蓋了IIS的驗證設定。
- 在B機器上，找到網站根目錄下的`Web.config`檔案，檢查是否有以下內容：
  ```xml
  <system.web>
      <authentication mode="Windows" />
  </system.web>
  ```
- 如果看到`authentication mode="Windows"`，這表示應用程式強制要求Windows驗證。改成以下內容以允許匿名訪問：
  ```xml
  <system.web>
      <authentication mode="None" />
      <authorization>
          <allow users="*" />
      </authorization>
  </system.web>
  ```
- 儲存後重新測試。

#### 4. 檢查應用程式池身分
- IIS的應用程式池身分也可能影響存取權限。
- 在B機器上：
  1. 打開IIS管理員，點擊「應用程式池」。
  2. 找到您的網站使用的應用程式池，右鍵點擊「進階設定」。
  3. 檢查「身分」(Identity) 是否設為`ApplicationPoolIdentity`（預設值）或其他帳戶。
  4. 確保該身分對`.asmx`檔案的資料夾有存取權限（類似步驟2）。
- 如果不確定，可以試著將身分改為`NetworkService`，然後重新啟動應用程式池。

#### 5. 比較A與B的差異
- 既然A正常運作而B有問題，檢查兩台的差異：
  - IIS版本是否相同？（例如Windows Server 2019上的IIS 10可能與舊版本行為不同）
  - 作業系統是否一致？
  - `.asmx`檔案的內容或路徑是否有差異？
  - 是否有防火牆或組策略（GPO）在B上強制要求驗證？

#### 6. 測試與驗證
- 在B上完成上述調整後，重新啟動IIS（在命令列輸入`iisreset`）。
- 用瀏覽器或工具（如Postman）訪問`.asmx`檔案，確認是否仍回401。

---

### 如果問題仍未解決
如果以上步驟都試過還是回401，請提供更多資訊：
- A和B的作業系統版本（例如Windows Server 2016或Windows 10）。
- IIS的完整錯誤訊息（401.1、401.2還是其他子狀態）。
- `.asmx`檔案是否需要特定的執行環境（例如.NET Framework版本）。

我會根據您的回饋進一步幫您解決！